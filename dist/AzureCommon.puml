' Azure-PlantUML, version 2.1.0
' https://github.com/plantuml-stdlib/Azure-PlantUML

' Colors
' ##################################
!define AZURE_COLOR #0072C6
!define AZURE_BG_COLOR #FFFFFF
!define AZURE_BORDER_COLOR #3C7FC0
!define AZURE_SYMBOL_COLOR AZURE_COLOR

' Styling
' ##################################

!define TECHN_FONT_SIZE 12

skinparam defaultTextAlignment center

skinparam PackageTitleAlignment Left

skinparam wrapWidth 200
skinparam maxMessageSize 150

skinparam rectangle {
    StereotypeFontSize 12
}

skinparam Arrow {
    Color #666666
    FontColor #666666
    FontSize 12
}

!definelong AzureEntityColoring(e_stereo)
skinparam rectangle<<e_stereo>> {
    BackgroundColor AZURE_BG_COLOR
    BorderColor AZURE_BORDER_COLOR
}
!enddefinelong

' "StereotypeFontSize 0" below will hide text
' still need "hide stereotype" in diagrams to hide whitespace
!definelong AzureGroupColoring(g_stereo, g_background_color, g_border_color, g_border_style)
skinparam rectangle<<g_stereo>> {
    StereotypeFontSize 0
    BackgroundColor g_background_color
    BorderColor g_border_color
    BorderStyle g_border_style
    Shadowing false
    RoundCorner 0
}
!enddefinelong

' Layout
' ##################################

!definelong LAYOUT_AS_SKETCH
skinparam backgroundColor #EEEBDC
skinparam handwritten true
skinparam defaultFontName "Comic Sans MS"
center footer <font color=red>Warning:</font> Created for discussion, needs to be validated
!enddefinelong

!define LAYOUT_TOP_DOWN top to bottom direction
!define LAYOUT_LEFT_RIGHT left to right direction

' Elements
' ##################################

!definelong AzureEntity(e_alias, e_label, e_techn, e_color, e_sprite, e_stereo)
rectangle "==e_label\n<color:e_color><$e_sprite></color>\n//<size:TECHN_FONT_SIZE>[e_techn]</size>//" <<e_stereo>> as e_alias
!enddefinelong

!definelong AzureEntity(e_alias, e_label, e_techn, e_descr, e_color, e_sprite, e_stereo)
rectangle "==e_label\n<color:e_color><$e_sprite></color>\n//<size:TECHN_FONT_SIZE>[e_techn]</size>//\n\n e_descr" <<e_stereo>> as e_alias
!enddefinelong

!function $AzureGroupImg($service)
!return %call_user_func("$" + $service + "IMG", "0.5")
!endfunction

' wraps each line (seperated by \n) of a multi-line label with color
!function $colorlabel($label, $color="black")
!$buffer = ""
!$tmp = $label
!$i = %strpos($tmp, "\n")
!while $i >= 0
  !$buffer = $buffer + %substr($tmp, 0, $i) + "</color>\n<color:" + $color + ">"
  !$tmp = %substr($tmp, $i + 2)
  !$i = %strpos($tmp, "\n")
!endwhile
!return "<color:" + $color + ">" + $buffer + $tmp + "</color>"
!endfunction

!definelong AzureGroupEntity(g_alias, g_label, g_color, g_stereo)
rectangle "$colorlabel(g_label, g_color)" as g_alias <<g_stereo>>
!enddefinelong

!definelong AzureGroupEntity(g_alias, g_label, g_color, g_sprite, g_stereo)
rectangle "$AzureGroupImg(g_sprite)  $colorlabel(g_label, g_color)" as g_alias <<g_stereo>>
!enddefinelong
